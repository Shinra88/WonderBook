import{r as o,u as F,j as s,R as j,k as y}from"./react-vendor-CHNrpsCK.js";import{T as S,j as C,H as T}from"./index-HN6HrZ4S.js";import{P as k}from"./vendor-DsLnOOP7.js";const b="KbrV7",N="_8S1G4",M="G4Vrz",L="peJlF",R="SP9Pz",A="QHpis",t={Login:b,Form:N,recaptchaContainer:M,validateButton:L,errorMessage:R,successMessage:A};function p({token:c}){const[n,w]=o.useState(""),[l,h]=o.useState(""),[i,r]=o.useState({error:!1,message:""}),[P,f]=o.useState(!1),[g,u]=o.useState(!1),[m,x]=o.useState(""),{t:e}=F(),v=async()=>{if(n!==l){r({error:!0,message:e("ForgetPassword.PasswordMismatch")});return}if(n.length<8){r({error:!0,message:e("ForgetPassword.PasswordTooShort")});return}if(!m){r({error:!0,message:e("ForgetPassword.CaptchaRequired")});return}try{u(!0);const a=await C.post(`/auth/reset-password/${c}`,{newPassword:n,recaptchaToken:m});a.data.success?(f(!0),r({error:!1,message:e("ForgetPassword.SuccessMessage")}),setTimeout(()=>{window.location.href="/"},2e3)):r({error:!0,message:a.data.message||e("ForgetPassword.UnknownError")})}catch(a){r({error:!0,message:a.response?.data?.message||e("ForgetPassword.ServerError")})}finally{u(!1)}};return s.jsx("div",{className:t.Login,children:s.jsxs("div",{className:t.Form,children:[P&&s.jsx(S,{message:e("ForgetPassword.SuccessMessage")}),s.jsx("h2",{children:e("ForgetPassword.ResetTitle")}),i.message&&s.jsx("div",{className:i.error?t.errorMessage:t.successMessage,children:i.message}),s.jsxs("label",{htmlFor:"newPassword",children:[e("ForgetPassword.NewPasswordLabel"),s.jsx("input",{type:"password",id:"newPassword",value:n,onChange:a=>w(a.target.value),placeholder:"Votre nouveau mot de passe"})]}),s.jsxs("label",{htmlFor:"confirmPassword",children:[e("ForgetPassword.ConfirmPasswordLabel"),s.jsx("input",{type:"password",id:"confirmPassword",value:l,onChange:a=>h(a.target.value),placeholder:"Confirmez votre nouveau mot de passe"})]}),s.jsx("div",{className:t.recaptchaContainer,children:s.jsx(j,{sitekey:"6LeySBQrAAAAAP6T4OxTqoVWFOEkBnp7Mfntsnes",onChange:a=>x(a)})}),s.jsx("button",{type:"button",onClick:v,className:t.validateButton,disabled:g,children:e(g?"ForgetPassword.Loading":"ForgetPassword.Validate")})]})})}p.propTypes={token:k.string.isRequired};const B="JGgUf",E="cJfyk",O="qnspS",d={pageContainer:B,background:E,modalOverlay:O};function z(){const{token:c}=y();return s.jsxs("div",{className:d.pageContainer,children:[s.jsx("div",{className:d.background,children:s.jsx(T,{})}),s.jsx("div",{className:d.modalOverlay,children:s.jsx(p,{token:c})})]})}export{z as default};
