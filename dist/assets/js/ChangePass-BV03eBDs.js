import{r as n,u as F,j as e}from"./react-vendor-CHNrpsCK.js";import{P as p}from"./vendor-DsLnOOP7.js";import{l as L}from"./index-HN6HrZ4S.js";const R="Po6ku",M="K3zJY",O="-dhBi",W="vk3Fa",z="aT5n-",q="eSXbb",A="jREjO",Z="vWg3e",_="_44NF-",I="t3xrf",J="Ih-XU",V="_4ksPJ",t={modalBackground:R,modalContent:M,buttonContainer:O,cancelButton:W,confirmButton:z,toggleBtn:q,passwordWrapper:A,errorText:Z,weak:_,medium:I,strong:J,invalid:V};function X({onClose:d,onSuccess:C}){const[l,x]=n.useState(""),[o,j]=n.useState(""),[c,S]=n.useState(""),[g,h]=n.useState(!1),[u,w]=n.useState({error:!1,message:""}),[i,v]=n.useState({}),[m,k]=n.useState(""),[P,N]=n.useState(!1),{t:a}=F(),b=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_\-+={};':"\\|,.<>/?]).{8,}$/,y=s=>{let r=0;return s.length>=8&&r++,/[A-Z]/.test(s)&&r++,/[a-z]/.test(s)&&r++,/\d/.test(s)&&r++,/[^A-Za-z0-9]/.test(s)&&r++,r<=2?a("ChangePass.PasswordStrengthWeak"):r<=4?a("ChangePass.PasswordStrengthMedium"):a("ChangePass.PasswordStrengthStrong")},B=()=>{const s={};return b.test(o)||(s.password=a("ChangePass.PasswordRequirements")),o!==c&&(s.confirmPassword=a("ChangePass.PasswordsDoNotMatch")),s},f=l&&o&&c&&Object.keys(i).length===0;n.useEffect(()=>{const s=r=>{r.key==="Escape"&&d()};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[d]),n.useEffect(()=>{v(B()),k(y(o))},[o,c]);const E=s=>{s.target.classList.contains(t.modalBackground)&&d()},T=async()=>{if(!f)return;h(!0);const s=await L(l,o);s.success?(w({error:!1,message:s.message}),setTimeout(()=>{C(),d()},1e3)):w({error:!0,message:s.message}),h(!1)};return e.jsx("div",{className:t.modalBackground,onClick:E,role:"presentation",children:e.jsxs("div",{className:t.modalContent,children:[e.jsx("h2",{children:a("ChangePass.Title")}),u.message&&e.jsx("div",{className:u.error?t.errorMessage:t.successMessage,children:u.message}),e.jsxs("label",{htmlFor:"oldPassword",children:[a("ChangePass.OldPassword"),e.jsx("input",{type:"password",id:"oldPassword",value:l,onChange:s=>x(s.target.value)})]}),e.jsxs("label",{htmlFor:"newPassword",children:[a("ChangePass.NewPassword"),e.jsxs("div",{className:t.passwordWrapper,children:[e.jsx("input",{type:P?"text":"password",id:"newPassword",value:o,onChange:s=>j(s.target.value),className:i.password?t.invalid:""}),e.jsx("button",{type:"button",className:t.toggleBtn,onClick:()=>N(s=>!s),children:P?"🙈":"👁️"})]})]}),e.jsx("small",{className:t.errorText,children:i.password||" "}),e.jsxs("label",{htmlFor:"confirmPassword",children:[a("ChangePass.ConfirmNewPassword"),e.jsx("input",{type:"password",id:"confirmPassword",value:c,onChange:s=>S(s.target.value),className:i.confirmPassword?t.invalid:""})]}),e.jsx("small",{className:t.errorText,children:i.confirmPassword||" "}),o&&e.jsxs("small",{className:m===a("ChangePass.PasswordStrengthStrong")?t.strong:m===a("ChangePass.PasswordStrengthMedium")?t.medium:t.weak,children:[a("ChangePass.PasswordStrength")," : ",m]}),e.jsxs("div",{className:t.buttonContainer,children:[e.jsx("button",{type:"button",className:t.cancelButton,onClick:d,children:a("ChangePass.Cancel")}),e.jsx("button",{type:"submit",className:t.confirmButton,onClick:T,disabled:!f||g,children:a(g?"ChangePass.Loading":"ChangePass.Validate")})]})]})})}X.propTypes={onClose:p.func.isRequired,onSuccess:p.func.isRequired};export{X as default};
