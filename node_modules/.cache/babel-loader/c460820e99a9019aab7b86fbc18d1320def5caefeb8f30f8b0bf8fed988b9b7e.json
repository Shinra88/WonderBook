{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\chokd\\\\Documents\\\\P3\\\\Projet7-Back-end\\\\frontend\\\\src\\\\Modals\\\\ChangePass\\\\ChangePass.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport PropTypes from 'prop-types';\nimport styles from './ChangePass.module.css';\nimport { API_ROUTES } from '../../utils/constants';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ChangePass(_ref) {\n  _s();\n  let {\n    onClose,\n    setUser\n  } = _ref;\n  const [oldPassword, setOldPassword] = useState('');\n  const [newPassword, setNewPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [notification, setNotification] = useState({\n    error: false,\n    message: ''\n  });\n\n  // Fermer la modal avec la touche \"Échap\"\n  useEffect(() => {\n    const handleEscape = event => {\n      if (event.key === 'Escape') {\n        onClose();\n      }\n    };\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [onClose]);\n\n  // Fermer la modal en cliquant à l'extérieur\n  const handleClickOutside = event => {\n    if (event.target.id === 'modal-background') {\n      onClose();\n    }\n  };\n  const changePass = async () => {\n    if (newPassword !== confirmPassword) {\n      setNotification({\n        error: true,\n        message: 'Les mots de passe ne correspondent pas.'\n      });\n      return;\n    }\n    try {\n      setIsLoading(true);\n      const response = await axios.post(API_ROUTES.CHANGE_PASS, {\n        oldPassword,\n        newPassword\n      });\n      if (response.status !== 200) {\n        setNotification({\n          error: true,\n          message: 'Une erreur est survenue.'\n        });\n      } else {\n        setNotification({\n          error: false,\n          message: 'Mot de passe changé avec succès !'\n        });\n        setTimeout(() => {\n          onClose(); // Ferme la modal après succès\n        }, 1000);\n      }\n    } catch (err) {\n      var _err$response, _err$response$data;\n      setNotification({\n        error: true,\n        message: ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Une erreur est survenue.'\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"modal-background\",\n    className: styles.modalBackground,\n    onClick: handleClickOutside,\n    role: \"presentation\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.modalContent,\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Changer le mot de passe\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 9\n      }, this), notification.message && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: notification.error ? styles.errorMessage : styles.successMessage,\n        children: notification.message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.formContainer,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"oldPassword\",\n          children: [\"Ancien mot de passe\", /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            id: \"oldPassword\",\n            value: oldPassword,\n            onChange: e => setOldPassword(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"newPassword\",\n          children: [\"Nouveau mot de passe\", /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            id: \"newPassword\",\n            value: newPassword,\n            onChange: e => setNewPassword(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"confirmPassword\",\n          children: [\"Confirmer mot de passe\", /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            id: \"confirmPassword\",\n            value: confirmPassword,\n            onChange: e => setConfirmPassword(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.buttonContainer,\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: styles.cancelButton,\n          onClick: onClose,\n          children: \"Annuler\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: styles.confirmButton,\n          onClick: changePass,\n          disabled: isLoading,\n          children: isLoading ? 'Chargement...' : 'Valider'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n}\n_s(ChangePass, \"0+mMg/2gmawQ0jPvHlYMKMJI+dE=\");\n_c = ChangePass;\nChangePass.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  setUser: PropTypes.func.isRequired\n};\nexport default ChangePass;\nvar _c;\n$RefreshReg$(_c, \"ChangePass\");","map":{"version":3,"names":["React","useState","useEffect","axios","PropTypes","styles","API_ROUTES","ChangePass","onClose","setUser","oldPassword","setOldPassword","newPassword","setNewPassword","confirmPassword","setConfirmPassword","isLoading","setIsLoading","notification","setNotification","error","message","handleEscape","event","key","document","addEventListener","removeEventListener","handleClickOutside","target","id","changePass","response","post","CHANGE_PASS","status","setTimeout","err","data","modalBackground","modalContent","errorMessage","successMessage","formContainer","e","value","buttonContainer","cancelButton","confirmButton","propTypes","func","isRequired"],"sources":["C:/Users/chokd/Documents/P3/Projet7-Back-end/frontend/src/Modals/ChangePass/ChangePass.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport PropTypes from 'prop-types';\nimport styles from './ChangePass.module.css';\nimport { API_ROUTES } from '../../utils/constants';\n\nfunction ChangePass({ onClose, setUser }) {\n  const [oldPassword, setOldPassword] = useState('');\n  const [newPassword, setNewPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [notification, setNotification] = useState({ error: false, message: '' });\n\n  // Fermer la modal avec la touche \"Échap\"\n  useEffect(() => {\n    const handleEscape = (event) => {\n      if (event.key === 'Escape') {\n        onClose();\n      }\n    };\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [onClose]);\n\n  // Fermer la modal en cliquant à l'extérieur\n  const handleClickOutside = (event) => {\n    if (event.target.id === 'modal-background') {\n      onClose();\n    }\n  };\n\n  const changePass = async () => {\n    if (newPassword !== confirmPassword) {\n      setNotification({ error: true, message: 'Les mots de passe ne correspondent pas.' });\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      const response = await axios.post(API_ROUTES.CHANGE_PASS, { oldPassword, newPassword });\n\n      if (response.status !== 200) {\n        setNotification({ error: true, message: 'Une erreur est survenue.' });\n      } else {\n        setNotification({ error: false, message: 'Mot de passe changé avec succès !' });\n        setTimeout(() => {\n          onClose(); // Ferme la modal après succès\n        }, 1000);\n      }\n    } catch (err) {\n      setNotification({ error: true, message: err.response?.data?.message || 'Une erreur est survenue.' });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div id=\"modal-background\" className={styles.modalBackground} onClick={handleClickOutside} role=\"presentation\">\n      <div className={styles.modalContent}>\n        <h2>Changer le mot de passe</h2>\n\n        {notification.message && (\n          <div className={notification.error ? styles.errorMessage : styles.successMessage}>\n            {notification.message}\n          </div>\n        )}\n\n        <div className={styles.formContainer}>\n          <label htmlFor=\"oldPassword\">\n            Ancien mot de passe\n            <input type=\"password\" id=\"oldPassword\" value={oldPassword} onChange={(e) => setOldPassword(e.target.value)} />\n          </label>\n\n          <label htmlFor=\"newPassword\">\n            Nouveau mot de passe\n            <input type=\"password\" id=\"newPassword\" value={newPassword} onChange={(e) => setNewPassword(e.target.value)} />\n          </label>\n\n          <label htmlFor=\"confirmPassword\">\n            Confirmer mot de passe\n            <input type=\"password\" id=\"confirmPassword\" value={confirmPassword} onChange={(e) => setConfirmPassword(e.target.value)} />\n          </label>\n        </div>\n\n        <div className={styles.buttonContainer}>\n          <button type=\"button\" className={styles.cancelButton} onClick={onClose}>\n            Annuler\n          </button>\n          <button type=\"submit\" className={styles.confirmButton} onClick={changePass} disabled={isLoading}>\n            {isLoading ? 'Chargement...' : 'Valider'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nChangePass.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  setUser: PropTypes.func.isRequired,\n};\n\nexport default ChangePass;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,SAAS,MAAM,YAAY;AAClC,OAAOC,MAAM,MAAM,yBAAyB;AAC5C,SAASC,UAAU,QAAQ,uBAAuB;AAAC;AAEnD,SAASC,UAAU,OAAuB;EAAA;EAAA,IAAtB;IAAEC,OAAO;IAAEC;EAAQ,CAAC;EACtC,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGV,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAM,CAACW,WAAW,EAAEC,cAAc,CAAC,GAAGZ,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAM,CAACa,eAAe,EAAEC,kBAAkB,CAAC,GAAGd,QAAQ,CAAC,EAAE,CAAC;EAC1D,MAAM,CAACe,SAAS,EAAEC,YAAY,CAAC,GAAGhB,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACiB,YAAY,EAAEC,eAAe,CAAC,GAAGlB,QAAQ,CAAC;IAAEmB,KAAK,EAAE,KAAK;IAAEC,OAAO,EAAE;EAAG,CAAC,CAAC;;EAE/E;EACAnB,SAAS,CAAC,MAAM;IACd,MAAMoB,YAAY,GAAIC,KAAK,IAAK;MAC9B,IAAIA,KAAK,CAACC,GAAG,KAAK,QAAQ,EAAE;QAC1BhB,OAAO,EAAE;MACX;IACF,CAAC;IACDiB,QAAQ,CAACC,gBAAgB,CAAC,SAAS,EAAEJ,YAAY,CAAC;IAClD,OAAO,MAAMG,QAAQ,CAACE,mBAAmB,CAAC,SAAS,EAAEL,YAAY,CAAC;EACpE,CAAC,EAAE,CAACd,OAAO,CAAC,CAAC;;EAEb;EACA,MAAMoB,kBAAkB,GAAIL,KAAK,IAAK;IACpC,IAAIA,KAAK,CAACM,MAAM,CAACC,EAAE,KAAK,kBAAkB,EAAE;MAC1CtB,OAAO,EAAE;IACX;EACF,CAAC;EAED,MAAMuB,UAAU,GAAG,YAAY;IAC7B,IAAInB,WAAW,KAAKE,eAAe,EAAE;MACnCK,eAAe,CAAC;QAAEC,KAAK,EAAE,IAAI;QAAEC,OAAO,EAAE;MAA0C,CAAC,CAAC;MACpF;IACF;IAEA,IAAI;MACFJ,YAAY,CAAC,IAAI,CAAC;MAClB,MAAMe,QAAQ,GAAG,MAAM7B,KAAK,CAAC8B,IAAI,CAAC3B,UAAU,CAAC4B,WAAW,EAAE;QAAExB,WAAW;QAAEE;MAAY,CAAC,CAAC;MAEvF,IAAIoB,QAAQ,CAACG,MAAM,KAAK,GAAG,EAAE;QAC3BhB,eAAe,CAAC;UAAEC,KAAK,EAAE,IAAI;UAAEC,OAAO,EAAE;QAA2B,CAAC,CAAC;MACvE,CAAC,MAAM;QACLF,eAAe,CAAC;UAAEC,KAAK,EAAE,KAAK;UAAEC,OAAO,EAAE;QAAoC,CAAC,CAAC;QAC/Ee,UAAU,CAAC,MAAM;UACf5B,OAAO,EAAE,CAAC,CAAC;QACb,CAAC,EAAE,IAAI,CAAC;MACV;IACF,CAAC,CAAC,OAAO6B,GAAG,EAAE;MAAA;MACZlB,eAAe,CAAC;QAAEC,KAAK,EAAE,IAAI;QAAEC,OAAO,EAAE,kBAAAgB,GAAG,CAACL,QAAQ,wEAAZ,cAAcM,IAAI,uDAAlB,mBAAoBjB,OAAO,KAAI;MAA2B,CAAC,CAAC;IACtG,CAAC,SAAS;MACRJ,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;EAED,oBACE;IAAK,EAAE,EAAC,kBAAkB;IAAC,SAAS,EAAEZ,MAAM,CAACkC,eAAgB;IAAC,OAAO,EAAEX,kBAAmB;IAAC,IAAI,EAAC,cAAc;IAAA,uBAC5G;MAAK,SAAS,EAAEvB,MAAM,CAACmC,YAAa;MAAA,wBAClC;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QAAgC,EAE/BtB,YAAY,CAACG,OAAO,iBACnB;QAAK,SAAS,EAAEH,YAAY,CAACE,KAAK,GAAGf,MAAM,CAACoC,YAAY,GAAGpC,MAAM,CAACqC,cAAe;QAAA,UAC9ExB,YAAY,CAACG;MAAO;QAAA;QAAA;QAAA;MAAA,QAExB,eAED;QAAK,SAAS,EAAEhB,MAAM,CAACsC,aAAc;QAAA,wBACnC;UAAO,OAAO,EAAC,aAAa;UAAA,+CAE1B;YAAO,IAAI,EAAC,UAAU;YAAC,EAAE,EAAC,aAAa;YAAC,KAAK,EAAEjC,WAAY;YAAC,QAAQ,EAAGkC,CAAC,IAAKjC,cAAc,CAACiC,CAAC,CAACf,MAAM,CAACgB,KAAK;UAAE;YAAA;YAAA;YAAA;UAAA,QAAG;QAAA;UAAA;UAAA;UAAA;QAAA,QACzG,eAER;UAAO,OAAO,EAAC,aAAa;UAAA,gDAE1B;YAAO,IAAI,EAAC,UAAU;YAAC,EAAE,EAAC,aAAa;YAAC,KAAK,EAAEjC,WAAY;YAAC,QAAQ,EAAGgC,CAAC,IAAK/B,cAAc,CAAC+B,CAAC,CAACf,MAAM,CAACgB,KAAK;UAAE;YAAA;YAAA;YAAA;UAAA,QAAG;QAAA;UAAA;UAAA;UAAA;QAAA,QACzG,eAER;UAAO,OAAO,EAAC,iBAAiB;UAAA,kDAE9B;YAAO,IAAI,EAAC,UAAU;YAAC,EAAE,EAAC,iBAAiB;YAAC,KAAK,EAAE/B,eAAgB;YAAC,QAAQ,EAAG8B,CAAC,IAAK7B,kBAAkB,CAAC6B,CAAC,CAACf,MAAM,CAACgB,KAAK;UAAE;YAAA;YAAA;YAAA;UAAA,QAAG;QAAA;UAAA;UAAA;UAAA;QAAA,QACrH;MAAA;QAAA;QAAA;QAAA;MAAA,QACJ,eAEN;QAAK,SAAS,EAAExC,MAAM,CAACyC,eAAgB;QAAA,wBACrC;UAAQ,IAAI,EAAC,QAAQ;UAAC,SAAS,EAAEzC,MAAM,CAAC0C,YAAa;UAAC,OAAO,EAAEvC,OAAQ;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QAE9D,eACT;UAAQ,IAAI,EAAC,QAAQ;UAAC,SAAS,EAAEH,MAAM,CAAC2C,aAAc;UAAC,OAAO,EAAEjB,UAAW;UAAC,QAAQ,EAAEf,SAAU;UAAA,UAC7FA,SAAS,GAAG,eAAe,GAAG;QAAS;UAAA;UAAA;UAAA;QAAA,QACjC;MAAA;QAAA;QAAA;QAAA;MAAA,QACL;IAAA;MAAA;MAAA;MAAA;IAAA;EACF;IAAA;IAAA;IAAA;EAAA,QACF;AAEV;AAAC,GAzFQT,UAAU;AAAA,KAAVA,UAAU;AA2FnBA,UAAU,CAAC0C,SAAS,GAAG;EACrBzC,OAAO,EAAEJ,SAAS,CAAC8C,IAAI,CAACC,UAAU;EAClC1C,OAAO,EAAEL,SAAS,CAAC8C,IAAI,CAACC;AAC1B,CAAC;AAED,eAAe5C,UAAU;AAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}